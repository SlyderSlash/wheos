{% extends 'base.html.twig' %}
{% block title %}WHEOS | FORUM
{% endblock %}

{% block body %}
	<section class="container">
		<div class="row my-3 align-items-center border-forum">
			<div class="col-1">
				<a href="{{ path('app_forum') }}" class="text-decoration-none text-dark" role="button">
					<i class="bi bi-chat-right-text-fill" style="font-size:64px;color:white"></i>
				</a>
			</div>
		</div>
		<div class="row my-3 align-items-center">
			<div class="col fs-6 text-uppercase mx-4">
				<a href="{{path('app_forum')}}" class="text-decoration-none forum-text-2">Home</a>
				<span class="text-success">
					>
				</span>
			</div>
		</div>
		<div class="row align-items-center my-3 ">
			<div class="col-2 logo-forum">
				<img src="logo_forum.jpg" alt="logo_forum" width="100" height="100">
			</div>
			<div class="col-10 text-start txt-forum-2">
				Forum d'entraide des stagiaires de l'AFPA.<br>
				Bienvenue sur le forum des stagiaires des centres afpa du france.
			</div>
		</div>
		{% if app.user %}
			<div class="row  border-forum p-2" id="category">
				{% for category in categories %}
					<div class="row">
						<div class="col-6 text-start bg-gradient-forum border-forum-rd-tl my-2 py-2" id="Collapse" 
								data-bs-toggle="collapse" data-bs-target="#{{category.name}}" 
								aria-expanded="false" aria-controls="{{category.name}}">
								<i class="fa-solid fa-folder-open forum-icon-folder glif-size-forum" onclick="changeIcon(this);"></i>
									{{category.name}}
						</div>
						<div class="col-2  text-end  bg-gradient-forum  my-2 py-2"></div>
						<div class="col-2  text-end  bg-gradient-forum  my-2 py-2">Messages</div>
						<div class="col-2 text-center bg-gradient-forum border-forum-rd-tr my-2 py-2">Date</div>
						<div class="row collapse show" id="{{category.name}}">
							{% for subcategory in subCat %}
								{% if (subcategory.parent.id == category.id) %}
									<div class="col-6 text-start ps-5">
										<i class="bi bi-folder-symlink-fill forum-icon-folder glif-size-forum"></i>
										<a href="{{ path('forum_subforum',{id:subcategory.id}) }}" class="text-decoration-none txt-forum-2" role="button">
											{{subcategory.name}}</a>
									</div>
									<div class="col-2 stars">
										<i class="bi bi-star star-forum" data-value="1"></i>
										<i class="bi bi-star star-forum" data-value="2"></i>
										<i class="bi bi-star star-forum" data-value="3"></i>
										<i class="bi bi-star star-forum" data-value="4"></i>
										<i class="bi bi-star star-forum" data-value="5"></i>
										<i class="bi bi-paperclip text-light"></i>
									</div>
									<div class="col-2 text-end txt-forum-2">
										{% set nbMessages = 0 %}
										{% for forum in forums %}
											{% if forum.category.id == subcategory.id %}
											{% for msg in messages %}
												{% if msg.forum == forum.id %}
													{% set nbMessages = msg.NB %}
												{% endif %}
											{% endfor %}
											{% endif %}
										{% endfor %}
										{{nbMessages}}
									</div>
									<div class="col-2 text-end txt-forum-2">
										{{subcategory.createdAt | date('d/m/Y')}}
									</div>
								{% endif %}
							{% endfor %}
						</div>
					</div>
				{% endfor %}
			</div>		
		{% else %}
			<div class="alert alert-danger alert-dismissible" role="alert">
				{#<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>#}
				<div class="alert-message">
					<p>Vous devez être connecté pour acceder au discussions</p>
				</div>
			</div>
		{% endif %}
		
	</section>

{% endblock %}
